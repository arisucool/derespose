<div class="search-form-container">
  <p class="caption">
    自分でポーズをとって探す
    <mat-icon style="vertical-align: middle; margin: 0 -2rem 4px 1rem">
      emoji_people
    </mat-icon>
    <br />
    <small
      >例えば、あなたが右手をあげると、デレスポARから、そのポーズのある曲を探します。<br />
      ※
      指の認識は開発中のため、ハートやピースなどのサインは未だ識別できません。</small
    >
  </p>
  <div class="camera-search-form simple-card">
    <div class="video-container">
      <!-- メッセージ領域 -->
      <div
        class="message"
        *ngIf="
          this.state === 'initializing' ||
          this.state === 'countdown' ||
          this.state === 'retrying'
        "
        [ngClass]="{ init: this.state === 'initializing' }"
      >
        <ng-container *ngIf="this.state === 'initializing'">
          しばらくお待ちください...
        </ng-container>
        <ng-container *ngIf="this.state === 'retrying'">
          一致するポーズがありません。もう一度試しましょう！
        </ng-container>
        <ng-container *ngIf="this.state === 'countdown'">
          <mat-icon>timer</mat-icon>
          あと {{ countdownRemainSeconds }} 秒でポーズを取ってください
        </ng-container>
      </div>
      <!---->
      <!-- シャッターアニメーション用領域 -->
      <div class="shutter" *ngIf="isEnableShutterAnimation"></div>
      <!---->
      <!-- カメラ映像領域 -->
      <video
        #cameraVideo
        [srcObject]="this.cameraVideoStream"
        [style.display]="this.cameraPosePreviewStream ? 'none' : 'block'"
        class="camera-preview"
        autoplay
        muted
        playsinline
      ></video>
      <video
        #cameraPosePreviewVideo
        [srcObject]="this.cameraPosePreviewStream"
        [style.display]="
          (this.cameraPosePreviewStream && this.searchTargetPoseImageDataUrl) ||
          !this.cameraPosePreviewStream
            ? 'none'
            : 'block'
        "
        class="camera-preview"
        autoplay
        muted
        playsinline
      ></video>
      <img
        class="camera-preview"
        *ngIf="this.searchTargetPoseImageDataUrl"
        [src]="this.searchTargetPoseImageDataUrl"
      />
      <!---->
    </div>

    <!-- 撮影/キャンセルボタン -->
    <div
      class="shutter-button-container"
      *ngIf="
        this.state === 'standby' ||
        this.state === 'completed' ||
        this.state === 'countdown'
      "
    >
      <button
        #shutterButton
        class="shutter-button"
        mat-button
        mat-stroked-button
        color="primary"
        (click)="this.startPhotoShootCountdown()"
        *ngIf="this.state === 'standby' || this.state === 'completed'"
      >
        <mat-icon style="margin-bottom: 2px">emoji_people</mat-icon>
        &nbsp;
        <ng-container *ngIf="this.state === 'standby'"> はじめる </ng-container>
        <ng-container *ngIf="this.state === 'completed'">
          もう一度
        </ng-container>
        &nbsp;
      </button>

      <button
        class="shutter-button"
        mat-button
        mat-stroked-button
        color="warn"
        (click)="this.cancelPhotoShootCountdown()"
        *ngIf="this.state === 'countdown'"
      >
        &nbsp; キャンセル &nbsp;
      </button>

      <button
        class="shutter-menu-button"
        mat-icon-button
        [matMenuTriggerFor]="shutterMenu"
        aria-label="ポーズ認識までの待ち時間"
        matTooltip="ポーズ認識までの待ち時間"
        [disabled]="this.state === 'countdown'"
      >
        <mat-icon *ngIf="this.countdownSecondsForDecidePose === 3"
          >timer_3</mat-icon
        >
        <mat-icon *ngIf="this.countdownSecondsForDecidePose === 10"
          >timer_10</mat-icon
        >
      </button>
      <mat-menu #shutterMenu="matMenu">
        <button
          (click)="this.setCountdownSecondsForDecidePose(3)"
          mat-menu-item
          [disabled]="this.countdownSecondsForDecidePose === 3"
        >
          <mat-icon>timer_3</mat-icon>
          <span>3秒後にポーズ認識</span>
        </button>
        <button
          (click)="this.setCountdownSecondsForDecidePose(10)"
          mat-menu-item
          [disabled]="this.countdownSecondsForDecidePose === 10"
        >
          <mat-icon>timer_10</mat-icon>
          <span>10秒後にポーズ認識</span>
        </button>
      </mat-menu>
    </div>
    <!---->
  </div>
</div>
